{"ast":null,"code":"// 真实的工作数据服务\n// 使用公开的API和RSS feed获取远程工作数据\nimport{LinkedInApiAdapter,WWRApiAdapter,CacheService}from'./api';// 导入RemoteOK API服务\nimport{fetchRemoteOKJobs}from'./realJobAPI';// 导入Jobspresso服务\nimport JobspressoService from'./jobspressoService';// 导入新的数据加载器和去重服务\nimport DataLoader from'./DataLoader';import DeduplicationService from'./DeduplicationService';// 导入生产环境配置\nimport{config}from'../config/production';// 创建API适配器实例\nconst linkedInAdapter=new LinkedInApiAdapter({clientId:process.env.REACT_APP_LINKEDIN_CLIENT_ID,clientSecret:process.env.REACT_APP_LINKEDIN_CLIENT_SECRET});const wwrAdapter=new WWRApiAdapter({apiKey:process.env.REACT_APP_RSS2JSON_API_KEY});// 创建Jobspresso服务实例\nconst jobspressoService=new JobspressoService();// 创建缓存服务实例\nconst cacheService=new CacheService({memoryTTL:config.cache.memoryTTL,storageTTL:config.cache.storageTTL});// 创建数据加载器实例\nconst dataLoader=new DataLoader({LinkedIn:linkedInAdapter,WeWorkRemotely:wwrAdapter,Jobspresso:{searchJobs:async(searchTerm,filters,page)=>{const result=await jobspressoService.fetchJobs(searchTerm,filters.category,page);return{jobs:result.jobs,total:result.total,page,pageSize:result.jobs.length};}},RemoteOK:{searchJobs:async(searchTerm,filters,page)=>{const jobs=await fetchRemoteOKJobs();return{jobs,total:jobs.length,page,pageSize:jobs.length};}}},cacheService);// 创建全局去重服务实例\nconst globalDeduplicationService=new DeduplicationService();// WeWorkRemotely API 集成\nexport const fetchWeWorkRemotelyJobs=async function(){let searchTerm=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';let category=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'';try{// 生成缓存键\nconst cacheKey=CacheService.generateKey('wwr_jobs',{searchTerm,category});// 检查缓存\nconst cachedData=await cacheService.get(cacheKey);if(cachedData){console.log('Using cached WeWorkRemotely jobs');return cachedData;}// 调用API\nconsole.log('Fetching WeWorkRemotely jobs with search term:',searchTerm,'and category:',category);const result=await wwrAdapter.searchJobs(searchTerm,category);// 缓存结果\nawait cacheService.set(cacheKey,result.jobs);return result.jobs;}catch(error){console.error('Error fetching WeWorkRemotely jobs:',error);// 返回空数组\nreturn[];}};// LinkedIn Jobs API 集成\nexport const fetchLinkedInJobs=async function(){let searchTerm=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';let location=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'remote';try{// 生成缓存键\nconst cacheKey=CacheService.generateKey('linkedin_jobs',{searchTerm,location});// 检查缓存\nconst cachedData=await cacheService.get(cacheKey);if(cachedData){console.log('Using cached LinkedIn jobs');return cachedData;}// 调用API\nconsole.log('Fetching LinkedIn jobs with search term:',searchTerm,'and location:',location);const result=await linkedInAdapter.searchJobs(searchTerm,{location},0);// 缓存结果\nawait cacheService.set(cacheKey,result.jobs);return result.jobs;}catch(error){console.error('Error fetching LinkedIn jobs:',error);// 返回空数组\nreturn[];}};// Jobspresso Jobs API 集成\nexport const fetchJobspressoJobs=async function(){let searchTerm=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';let category=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'';try{// 生成缓存键\nconst cacheKey=CacheService.generateKey('jobspresso_jobs',{searchTerm,category});// 检查缓存\nconst cachedData=await cacheService.get(cacheKey);if(cachedData){console.log('Using cached Jobspresso jobs');return cachedData;}// 调用API\nconsole.log('Fetching Jobspresso jobs with search term:',searchTerm,'and category:',category);const result=await jobspressoService.fetchJobs(searchTerm,category);// 缓存结果\nawait cacheService.set(cacheKey,result.jobs);return result.jobs;}catch(error){console.error('Error fetching Jobspresso jobs:',error);// 返回空数组\nreturn[];}};// 通用的远程工作搜索函数 - 使用新的DataLoader确保无重复\nexport const searchRemoteJobs=async function(){let searchTerm=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';let filters=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};let page=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;let pageSize=arguments.length>3&&arguments[3]!==undefined?arguments[3]:50;try{console.log(`搜索远程工作 - 关键词: \"${searchTerm}\", 页码: ${page}, 页面大小: ${pageSize}`);// 使用DataLoader获取去重后的数据\nconst result=await dataLoader.loadJobsFromAllSources(searchTerm,filters,page,pageSize);// 如果没有数据，尝试使用旧的方法作为备选\nif(result.jobs.length===0&&page===0){console.log('DataLoader未返回数据，尝试备选方法...');return await searchRemoteJobsFallback(searchTerm,filters);}// 记录去重统计信息\nif(result.deduplicationStats){console.log('去重统计:',result.deduplicationStats);}return{jobs:result.jobs,total:result.total,totalAvailable:result.totalAvailable,page:result.page,pageSize:result.pageSize,hasMore:result.hasMore,sources:result.sources||[],deduplicationStats:result.deduplicationStats};}catch(error){console.error('Error searching remote jobs:',error);// 错误时尝试备选方法\nif(page===0){console.log('主要方法失败，尝试备选方法...');return await searchRemoteJobsFallback(searchTerm,filters);}// 返回空结果\nreturn{jobs:[],total:0,totalAvailable:0,page:page,pageSize:pageSize,hasMore:false,sources:[],error:error.message};}};// 备选的搜索方法（保持向后兼容）\nconst searchRemoteJobsFallback=async function(){let searchTerm=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';let filters=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};try{console.log('使用备选搜索方法...');// 并行调用多个API，包括Jobspresso\nconst[weWorkJobs,linkedInJobs,jobspressoJobs,remoteOKJobs]=await Promise.allSettled([fetchWeWorkRemotelyJobs(searchTerm,filters.category),fetchLinkedInJobs(searchTerm,filters.location||'remote'),fetchJobspressoJobs(searchTerm,filters.category),fetchRemoteOKJobs()]);// 合并结果\nconst allJobs=[...(weWorkJobs.status==='fulfilled'?weWorkJobs.value:[]),...(linkedInJobs.status==='fulfilled'?linkedInJobs.value:[]),...(jobspressoJobs.status==='fulfilled'?jobspressoJobs.value:[]),...(remoteOKJobs.status==='fulfilled'?remoteOKJobs.value:[])];// 如果所有API都失败，返回空结果\nif(allJobs.length===0){console.error('Failed to fetch jobs from any source');return{jobs:[],total:0,sources:[]};}// 使用全局去重服务进行去重\nconst uniqueJobs=globalDeduplicationService.deduplicateJobs(allJobs);// 按搜索词过滤\nlet filteredJobs=uniqueJobs;if(searchTerm){filteredJobs=uniqueJobs.filter(job=>job.title.toLowerCase().includes(searchTerm.toLowerCase())||job.company.toLowerCase().includes(searchTerm.toLowerCase())||job.description.toLowerCase().includes(searchTerm.toLowerCase())||job.skills&&job.skills.some(skill=>skill.toLowerCase().includes(searchTerm.toLowerCase())));}// 应用其他筛选条件\nif(filters.jobType){filteredJobs=filteredJobs.filter(job=>job.type&&job.type.toLowerCase()===filters.jobType.toLowerCase());}if(filters.salary){const{min,max}=filters.salary;filteredJobs=filteredJobs.filter(job=>(!min||job.salary>=min)&&(!max||job.salary<=max));}// 排序\nconst sortedJobs=sortJobs(filteredJobs,filters.sort||'date');// 获取数据来源\nconst sources=[...new Set(sortedJobs.map(job=>job.source))];const result={jobs:sortedJobs,total:sortedJobs.length,sources,deduplicationStats:globalDeduplicationService.getStats()};console.log(`备选方法完成 - 返回 ${sortedJobs.length} 个唯一工作`);console.log('去重统计:',globalDeduplicationService.getStats());return result;}catch(error){console.error('Error in fallback search:',error);return{jobs:[],total:0,sources:[],error:error.message};}};// 获取工作详情\nexport const getJobDetails=async(jobId,source)=>{try{// 生成缓存键\nconst cacheKey=`job_detail_${jobId}`;// 检查缓存\nconst cachedData=await cacheService.get(cacheKey);if(cachedData){console.log('Using cached job details');return cachedData;}// 根据来源选择适当的API适配器\nlet jobDetail;switch(source){case'LinkedIn':jobDetail=await linkedInAdapter.getJobDetails(jobId);break;case'WeWorkRemotely':jobDetail=await wwrAdapter.getJobDetails(jobId);break;default:// 如果没有指定来源或来源不支持，尝试从所有适配器获取\nconst results=await Promise.allSettled([linkedInAdapter.getJobDetails(jobId),wwrAdapter.getJobDetails(jobId)]);// 使用第一个成功的结果\nconst successResult=results.find(result=>result.status==='fulfilled');if(successResult){jobDetail=successResult.value;}else{throw new Error(`Job with ID ${jobId} not found`);}}// 缓存结果\nawait cacheService.set(cacheKey,jobDetail);return jobDetail;}catch(error){console.error(`Error fetching job details for ${jobId}:`,error);throw error;}};// 刷新缓存\nexport const refreshCache=async()=>{try{await cacheService.clear();console.log('Job cache cleared');return{success:true};}catch(error){console.error('Error clearing job cache:',error);return{success:false,error:error.message};}};// 获取缓存统计\nexport const getCacheStats=()=>{return cacheService.getStats();};// 增强的去重函数\nconst removeDuplicateJobs=jobs=>{const seen=new Set();const seenIds=new Set();return jobs.filter(job=>{// 首先检查ID是否重复\nif(job.id&&seenIds.has(job.id)){console.log(`Duplicate job ID found: ${job.id} - ${job.title} at ${job.company}`);return false;}// 创建多个唯一标识符来检查重复\nconst titleCompanyKey=`${job.title}-${job.company}`.toLowerCase().replace(/\\s+/g,'');const titleLocationKey=`${job.title}-${job.location}`.toLowerCase().replace(/\\s+/g,'');const companyTitleKey=`${job.company}-${job.title}`.toLowerCase().replace(/\\s+/g,'');// 检查是否已存在相似的工作\nif(seen.has(titleCompanyKey)||seen.has(titleLocationKey)||seen.has(companyTitleKey)){console.log(`Duplicate job found: ${job.title} at ${job.company}`);return false;}// 额外检查：如果标题和公司名称非常相似，也认为是重复\nfor(const existingKey of seen){const similarity=calculateSimilarity(titleCompanyKey,existingKey);if(similarity>0.85){// 85%相似度阈值\nconsole.log(`Similar job found (${Math.round(similarity*100)}% similarity): ${job.title} at ${job.company}`);return false;}}// 记录所有标识符\nif(job.id)seenIds.add(job.id);seen.add(titleCompanyKey);seen.add(titleLocationKey);seen.add(companyTitleKey);return true;});};// 计算字符串相似度的简单函数\nconst calculateSimilarity=(str1,str2)=>{const longer=str1.length>str2.length?str1:str2;const shorter=str1.length>str2.length?str2:str1;if(longer.length===0)return 1.0;const editDistance=levenshteinDistance(longer,shorter);return(longer.length-editDistance)/longer.length;};// 计算编辑距离\nconst levenshteinDistance=(str1,str2)=>{const matrix=[];for(let i=0;i<=str2.length;i++){matrix[i]=[i];}for(let j=0;j<=str1.length;j++){matrix[0][j]=j;}for(let i=1;i<=str2.length;i++){for(let j=1;j<=str1.length;j++){if(str2.charAt(i-1)===str1.charAt(j-1)){matrix[i][j]=matrix[i-1][j-1];}else{matrix[i][j]=Math.min(matrix[i-1][j-1]+1,matrix[i][j-1]+1,matrix[i-1][j]+1);}}}return matrix[str2.length][str1.length];};// 排序函数\nconst sortJobs=function(jobs){let sortBy=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'date';const sortedJobs=[...jobs];switch(sortBy){case'date':// 按发布日期排序（最新的在前面）\nreturn sortedJobs.sort((a,b)=>{// 优先显示\"Today\"\nif(a.postedDate==='Today'&&b.postedDate!=='Today')return-1;if(a.postedDate!=='Today'&&b.postedDate==='Today')return 1;// 优先显示\"Yesterday\"\nif(a.postedDate==='Yesterday'&&b.postedDate!=='Yesterday'&&b.postedDate!=='Today')return-1;if(a.postedDate!=='Yesterday'&&a.postedDate!=='Today'&&b.postedDate==='Yesterday')return 1;// 比较天数\nconst getNumericDays=dateStr=>{if(dateStr.includes('days ago')){return parseInt(dateStr.split(' ')[0],10);}if(dateStr.includes('weeks ago')){return parseInt(dateStr.split(' ')[0],10)*7;}if(dateStr.includes('months ago')){return parseInt(dateStr.split(' ')[0],10)*30;}return 0;};return getNumericDays(a.postedDate)-getNumericDays(b.postedDate);});case'salary':// 按薪资排序（高的在前面）\nreturn sortedJobs.sort((a,b)=>(b.salary||0)-(a.salary||0));case'company':// 按公司名称排序\nreturn sortedJobs.sort((a,b)=>a.company.localeCompare(b.company));case'title':// 按职位名称排序\nreturn sortedJobs.sort((a,b)=>a.title.localeCompare(b.title));default:return sortedJobs;}};export default{searchRemoteJobs,fetchWeWorkRemotelyJobs,fetchLinkedInJobs,getJobDetails,refreshCache,getCacheStats};","map":{"version":3,"names":["LinkedInApiAdapter","WWRApiAdapter","CacheService","fetchRemoteOKJobs","JobspressoService","DataLoader","DeduplicationService","config","linkedInAdapter","clientId","process","env","REACT_APP_LINKEDIN_CLIENT_ID","clientSecret","REACT_APP_LINKEDIN_CLIENT_SECRET","wwrAdapter","apiKey","REACT_APP_RSS2JSON_API_KEY","jobspressoService","cacheService","memoryTTL","cache","storageTTL","dataLoader","LinkedIn","WeWorkRemotely","Jobspresso","searchJobs","searchTerm","filters","page","result","fetchJobs","category","jobs","total","pageSize","length","RemoteOK","globalDeduplicationService","fetchWeWorkRemotelyJobs","arguments","undefined","cacheKey","generateKey","cachedData","get","console","log","set","error","fetchLinkedInJobs","location","fetchJobspressoJobs","searchRemoteJobs","loadJobsFromAllSources","searchRemoteJobsFallback","deduplicationStats","totalAvailable","hasMore","sources","message","weWorkJobs","linkedInJobs","jobspressoJobs","remoteOKJobs","Promise","allSettled","allJobs","status","value","uniqueJobs","deduplicateJobs","filteredJobs","filter","job","title","toLowerCase","includes","company","description","skills","some","skill","jobType","type","salary","min","max","sortedJobs","sortJobs","sort","Set","map","source","getStats","getJobDetails","jobId","jobDetail","results","successResult","find","Error","refreshCache","clear","success","getCacheStats","removeDuplicateJobs","seen","seenIds","id","has","titleCompanyKey","replace","titleLocationKey","companyTitleKey","existingKey","similarity","calculateSimilarity","Math","round","add","str1","str2","longer","shorter","editDistance","levenshteinDistance","matrix","i","j","charAt","sortBy","a","b","postedDate","getNumericDays","dateStr","parseInt","split","localeCompare"],"sources":["D:/Kiro/remote-job-website/src/services/jobService.js"],"sourcesContent":["// 真实的工作数据服务\r\n// 使用公开的API和RSS feed获取远程工作数据\r\nimport { \r\n  LinkedInApiAdapter, \r\n  WWRApiAdapter, \r\n  CacheService \r\n} from './api';\r\n\r\n// 导入RemoteOK API服务\r\nimport { fetchRemoteOKJobs } from './realJobAPI';\r\n\r\n// 导入Jobspresso服务\r\nimport JobspressoService from './jobspressoService';\r\n\r\n// 导入新的数据加载器和去重服务\r\nimport DataLoader from './DataLoader';\r\nimport DeduplicationService from './DeduplicationService';\r\n\r\n// 导入生产环境配置\r\nimport { config } from '../config/production';\r\n\r\n// 创建API适配器实例\r\nconst linkedInAdapter = new LinkedInApiAdapter({\r\n  clientId: process.env.REACT_APP_LINKEDIN_CLIENT_ID,\r\n  clientSecret: process.env.REACT_APP_LINKEDIN_CLIENT_SECRET\r\n});\r\n\r\nconst wwrAdapter = new WWRApiAdapter({\r\n  apiKey: process.env.REACT_APP_RSS2JSON_API_KEY\r\n});\r\n\r\n// 创建Jobspresso服务实例\r\nconst jobspressoService = new JobspressoService();\r\n\r\n// 创建缓存服务实例\r\nconst cacheService = new CacheService({\r\n  memoryTTL: config.cache.memoryTTL,\r\n  storageTTL: config.cache.storageTTL\r\n});\r\n\r\n// 创建数据加载器实例\r\nconst dataLoader = new DataLoader({\r\n  LinkedIn: linkedInAdapter,\r\n  WeWorkRemotely: wwrAdapter,\r\n  Jobspresso: {\r\n    searchJobs: async (searchTerm, filters, page) => {\r\n      const result = await jobspressoService.fetchJobs(searchTerm, filters.category, page);\r\n      return { jobs: result.jobs, total: result.total, page, pageSize: result.jobs.length };\r\n    }\r\n  },\r\n  RemoteOK: { \r\n    searchJobs: async (searchTerm, filters, page) => {\r\n      const jobs = await fetchRemoteOKJobs();\r\n      return { jobs, total: jobs.length, page, pageSize: jobs.length };\r\n    }\r\n  }\r\n}, cacheService);\r\n\r\n// 创建全局去重服务实例\r\nconst globalDeduplicationService = new DeduplicationService();\r\n\r\n// WeWorkRemotely API 集成\r\nexport const fetchWeWorkRemotelyJobs = async (searchTerm = '', category = '') => {\r\n  try {\r\n    // 生成缓存键\r\n    const cacheKey = CacheService.generateKey('wwr_jobs', { searchTerm, category });\r\n    \r\n    // 检查缓存\r\n    const cachedData = await cacheService.get(cacheKey);\r\n    if (cachedData) {\r\n      console.log('Using cached WeWorkRemotely jobs');\r\n      return cachedData;\r\n    }\r\n    \r\n    // 调用API\r\n    console.log('Fetching WeWorkRemotely jobs with search term:', searchTerm, 'and category:', category);\r\n    const result = await wwrAdapter.searchJobs(searchTerm, category);\r\n    \r\n    // 缓存结果\r\n    await cacheService.set(cacheKey, result.jobs);\r\n    \r\n    return result.jobs;\r\n  } catch (error) {\r\n    console.error('Error fetching WeWorkRemotely jobs:', error);\r\n    // 返回空数组\r\n    return [];\r\n  }\r\n};\r\n\r\n// LinkedIn Jobs API 集成\r\nexport const fetchLinkedInJobs = async (searchTerm = '', location = 'remote') => {\r\n  try {\r\n    // 生成缓存键\r\n    const cacheKey = CacheService.generateKey('linkedin_jobs', { searchTerm, location });\r\n    \r\n    // 检查缓存\r\n    const cachedData = await cacheService.get(cacheKey);\r\n    if (cachedData) {\r\n      console.log('Using cached LinkedIn jobs');\r\n      return cachedData;\r\n    }\r\n    \r\n    // 调用API\r\n    console.log('Fetching LinkedIn jobs with search term:', searchTerm, 'and location:', location);\r\n    const result = await linkedInAdapter.searchJobs(searchTerm, { location }, 0);\r\n    \r\n    // 缓存结果\r\n    await cacheService.set(cacheKey, result.jobs);\r\n    \r\n    return result.jobs;\r\n  } catch (error) {\r\n    console.error('Error fetching LinkedIn jobs:', error);\r\n    // 返回空数组\r\n    return [];\r\n  }\r\n};\r\n\r\n// Jobspresso Jobs API 集成\r\nexport const fetchJobspressoJobs = async (searchTerm = '', category = '') => {\r\n  try {\r\n    // 生成缓存键\r\n    const cacheKey = CacheService.generateKey('jobspresso_jobs', { searchTerm, category });\r\n    \r\n    // 检查缓存\r\n    const cachedData = await cacheService.get(cacheKey);\r\n    if (cachedData) {\r\n      console.log('Using cached Jobspresso jobs');\r\n      return cachedData;\r\n    }\r\n    \r\n    // 调用API\r\n    console.log('Fetching Jobspresso jobs with search term:', searchTerm, 'and category:', category);\r\n    const result = await jobspressoService.fetchJobs(searchTerm, category);\r\n    \r\n    // 缓存结果\r\n    await cacheService.set(cacheKey, result.jobs);\r\n    \r\n    return result.jobs;\r\n  } catch (error) {\r\n    console.error('Error fetching Jobspresso jobs:', error);\r\n    // 返回空数组\r\n    return [];\r\n  }\r\n};\r\n\r\n// 通用的远程工作搜索函数 - 使用新的DataLoader确保无重复\r\nexport const searchRemoteJobs = async (searchTerm = '', filters = {}, page = 0, pageSize = 50) => {\r\n  try {\r\n    console.log(`搜索远程工作 - 关键词: \"${searchTerm}\", 页码: ${page}, 页面大小: ${pageSize}`);\r\n    \r\n    // 使用DataLoader获取去重后的数据\r\n    const result = await dataLoader.loadJobsFromAllSources(searchTerm, filters, page, pageSize);\r\n    \r\n    // 如果没有数据，尝试使用旧的方法作为备选\r\n    if (result.jobs.length === 0 && page === 0) {\r\n      console.log('DataLoader未返回数据，尝试备选方法...');\r\n      return await searchRemoteJobsFallback(searchTerm, filters);\r\n    }\r\n    \r\n    // 记录去重统计信息\r\n    if (result.deduplicationStats) {\r\n      console.log('去重统计:', result.deduplicationStats);\r\n    }\r\n    \r\n    return {\r\n      jobs: result.jobs,\r\n      total: result.total,\r\n      totalAvailable: result.totalAvailable,\r\n      page: result.page,\r\n      pageSize: result.pageSize,\r\n      hasMore: result.hasMore,\r\n      sources: result.sources || [],\r\n      deduplicationStats: result.deduplicationStats\r\n    };\r\n    \r\n  } catch (error) {\r\n    console.error('Error searching remote jobs:', error);\r\n    \r\n    // 错误时尝试备选方法\r\n    if (page === 0) {\r\n      console.log('主要方法失败，尝试备选方法...');\r\n      return await searchRemoteJobsFallback(searchTerm, filters);\r\n    }\r\n    \r\n    // 返回空结果\r\n    return {\r\n      jobs: [],\r\n      total: 0,\r\n      totalAvailable: 0,\r\n      page: page,\r\n      pageSize: pageSize,\r\n      hasMore: false,\r\n      sources: [],\r\n      error: error.message\r\n    };\r\n  }\r\n};\r\n\r\n// 备选的搜索方法（保持向后兼容）\r\nconst searchRemoteJobsFallback = async (searchTerm = '', filters = {}) => {\r\n  try {\r\n    console.log('使用备选搜索方法...');\r\n    \r\n    // 并行调用多个API，包括Jobspresso\r\n    const [weWorkJobs, linkedInJobs, jobspressoJobs, remoteOKJobs] = await Promise.allSettled([\r\n      fetchWeWorkRemotelyJobs(searchTerm, filters.category),\r\n      fetchLinkedInJobs(searchTerm, filters.location || 'remote'),\r\n      fetchJobspressoJobs(searchTerm, filters.category),\r\n      fetchRemoteOKJobs()\r\n    ]);\r\n    \r\n    // 合并结果\r\n    const allJobs = [\r\n      ...(weWorkJobs.status === 'fulfilled' ? weWorkJobs.value : []),\r\n      ...(linkedInJobs.status === 'fulfilled' ? linkedInJobs.value : []),\r\n      ...(jobspressoJobs.status === 'fulfilled' ? jobspressoJobs.value : []),\r\n      ...(remoteOKJobs.status === 'fulfilled' ? remoteOKJobs.value : [])\r\n    ];\r\n    \r\n    // 如果所有API都失败，返回空结果\r\n    if (allJobs.length === 0) {\r\n      console.error('Failed to fetch jobs from any source');\r\n      return {\r\n        jobs: [],\r\n        total: 0,\r\n        sources: []\r\n      };\r\n    }\r\n    \r\n    // 使用全局去重服务进行去重\r\n    const uniqueJobs = globalDeduplicationService.deduplicateJobs(allJobs);\r\n    \r\n    // 按搜索词过滤\r\n    let filteredJobs = uniqueJobs;\r\n    if (searchTerm) {\r\n      filteredJobs = uniqueJobs.filter(job => \r\n        job.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        job.company.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        job.description.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        (job.skills && job.skills.some(skill => \r\n          skill.toLowerCase().includes(searchTerm.toLowerCase())\r\n        ))\r\n      );\r\n    }\r\n    \r\n    // 应用其他筛选条件\r\n    if (filters.jobType) {\r\n      filteredJobs = filteredJobs.filter(job => \r\n        job.type && job.type.toLowerCase() === filters.jobType.toLowerCase()\r\n      );\r\n    }\r\n    \r\n    if (filters.salary) {\r\n      const { min, max } = filters.salary;\r\n      filteredJobs = filteredJobs.filter(job => \r\n        (!min || job.salary >= min) && (!max || job.salary <= max)\r\n      );\r\n    }\r\n    \r\n    // 排序\r\n    const sortedJobs = sortJobs(filteredJobs, filters.sort || 'date');\r\n    \r\n    // 获取数据来源\r\n    const sources = [...new Set(sortedJobs.map(job => job.source))];\r\n    \r\n    const result = {\r\n      jobs: sortedJobs,\r\n      total: sortedJobs.length,\r\n      sources,\r\n      deduplicationStats: globalDeduplicationService.getStats()\r\n    };\r\n    \r\n    console.log(`备选方法完成 - 返回 ${sortedJobs.length} 个唯一工作`);\r\n    console.log('去重统计:', globalDeduplicationService.getStats());\r\n    \r\n    return result;\r\n  } catch (error) {\r\n    console.error('Error in fallback search:', error);\r\n    return {\r\n      jobs: [],\r\n      total: 0,\r\n      sources: [],\r\n      error: error.message\r\n    };\r\n  }\r\n};\r\n\r\n// 获取工作详情\r\nexport const getJobDetails = async (jobId, source) => {\r\n  try {\r\n    // 生成缓存键\r\n    const cacheKey = `job_detail_${jobId}`;\r\n    \r\n    // 检查缓存\r\n    const cachedData = await cacheService.get(cacheKey);\r\n    if (cachedData) {\r\n      console.log('Using cached job details');\r\n      return cachedData;\r\n    }\r\n    \r\n    // 根据来源选择适当的API适配器\r\n    let jobDetail;\r\n    switch (source) {\r\n      case 'LinkedIn':\r\n        jobDetail = await linkedInAdapter.getJobDetails(jobId);\r\n        break;\r\n      case 'WeWorkRemotely':\r\n        jobDetail = await wwrAdapter.getJobDetails(jobId);\r\n        break;\r\n      default:\r\n        // 如果没有指定来源或来源不支持，尝试从所有适配器获取\r\n        const results = await Promise.allSettled([\r\n          linkedInAdapter.getJobDetails(jobId),\r\n          wwrAdapter.getJobDetails(jobId)\r\n        ]);\r\n        \r\n        // 使用第一个成功的结果\r\n        const successResult = results.find(result => result.status === 'fulfilled');\r\n        if (successResult) {\r\n          jobDetail = successResult.value;\r\n        } else {\r\n          throw new Error(`Job with ID ${jobId} not found`);\r\n        }\r\n    }\r\n    \r\n    // 缓存结果\r\n    await cacheService.set(cacheKey, jobDetail);\r\n    \r\n    return jobDetail;\r\n  } catch (error) {\r\n    console.error(`Error fetching job details for ${jobId}:`, error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// 刷新缓存\r\nexport const refreshCache = async () => {\r\n  try {\r\n    await cacheService.clear();\r\n    console.log('Job cache cleared');\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('Error clearing job cache:', error);\r\n    return { success: false, error: error.message };\r\n  }\r\n};\r\n\r\n// 获取缓存统计\r\nexport const getCacheStats = () => {\r\n  return cacheService.getStats();\r\n};\r\n\r\n// 增强的去重函数\r\nconst removeDuplicateJobs = (jobs) => {\r\n  const seen = new Set();\r\n  const seenIds = new Set();\r\n  \r\n  return jobs.filter(job => {\r\n    // 首先检查ID是否重复\r\n    if (job.id && seenIds.has(job.id)) {\r\n      console.log(`Duplicate job ID found: ${job.id} - ${job.title} at ${job.company}`);\r\n      return false;\r\n    }\r\n    \r\n    // 创建多个唯一标识符来检查重复\r\n    const titleCompanyKey = `${job.title}-${job.company}`.toLowerCase().replace(/\\s+/g, '');\r\n    const titleLocationKey = `${job.title}-${job.location}`.toLowerCase().replace(/\\s+/g, '');\r\n    const companyTitleKey = `${job.company}-${job.title}`.toLowerCase().replace(/\\s+/g, '');\r\n    \r\n    // 检查是否已存在相似的工作\r\n    if (seen.has(titleCompanyKey) || seen.has(titleLocationKey) || seen.has(companyTitleKey)) {\r\n      console.log(`Duplicate job found: ${job.title} at ${job.company}`);\r\n      return false;\r\n    }\r\n    \r\n    // 额外检查：如果标题和公司名称非常相似，也认为是重复\r\n    for (const existingKey of seen) {\r\n      const similarity = calculateSimilarity(titleCompanyKey, existingKey);\r\n      if (similarity > 0.85) { // 85%相似度阈值\r\n        console.log(`Similar job found (${Math.round(similarity * 100)}% similarity): ${job.title} at ${job.company}`);\r\n        return false;\r\n      }\r\n    }\r\n    \r\n    // 记录所有标识符\r\n    if (job.id) seenIds.add(job.id);\r\n    seen.add(titleCompanyKey);\r\n    seen.add(titleLocationKey);\r\n    seen.add(companyTitleKey);\r\n    \r\n    return true;\r\n  });\r\n};\r\n\r\n// 计算字符串相似度的简单函数\r\nconst calculateSimilarity = (str1, str2) => {\r\n  const longer = str1.length > str2.length ? str1 : str2;\r\n  const shorter = str1.length > str2.length ? str2 : str1;\r\n  \r\n  if (longer.length === 0) return 1.0;\r\n  \r\n  const editDistance = levenshteinDistance(longer, shorter);\r\n  return (longer.length - editDistance) / longer.length;\r\n};\r\n\r\n// 计算编辑距离\r\nconst levenshteinDistance = (str1, str2) => {\r\n  const matrix = [];\r\n  \r\n  for (let i = 0; i <= str2.length; i++) {\r\n    matrix[i] = [i];\r\n  }\r\n  \r\n  for (let j = 0; j <= str1.length; j++) {\r\n    matrix[0][j] = j;\r\n  }\r\n  \r\n  for (let i = 1; i <= str2.length; i++) {\r\n    for (let j = 1; j <= str1.length; j++) {\r\n      if (str2.charAt(i - 1) === str1.charAt(j - 1)) {\r\n        matrix[i][j] = matrix[i - 1][j - 1];\r\n      } else {\r\n        matrix[i][j] = Math.min(\r\n          matrix[i - 1][j - 1] + 1,\r\n          matrix[i][j - 1] + 1,\r\n          matrix[i - 1][j] + 1\r\n        );\r\n      }\r\n    }\r\n  }\r\n  \r\n  return matrix[str2.length][str1.length];\r\n};\r\n\r\n// 排序函数\r\nconst sortJobs = (jobs, sortBy = 'date') => {\r\n  const sortedJobs = [...jobs];\r\n  \r\n  switch (sortBy) {\r\n    case 'date':\r\n      // 按发布日期排序（最新的在前面）\r\n      return sortedJobs.sort((a, b) => {\r\n        // 优先显示\"Today\"\r\n        if (a.postedDate === 'Today' && b.postedDate !== 'Today') return -1;\r\n        if (a.postedDate !== 'Today' && b.postedDate === 'Today') return 1;\r\n        \r\n        // 优先显示\"Yesterday\"\r\n        if (a.postedDate === 'Yesterday' && b.postedDate !== 'Yesterday' && b.postedDate !== 'Today') return -1;\r\n        if (a.postedDate !== 'Yesterday' && a.postedDate !== 'Today' && b.postedDate === 'Yesterday') return 1;\r\n        \r\n        // 比较天数\r\n        const getNumericDays = (dateStr) => {\r\n          if (dateStr.includes('days ago')) {\r\n            return parseInt(dateStr.split(' ')[0], 10);\r\n          }\r\n          if (dateStr.includes('weeks ago')) {\r\n            return parseInt(dateStr.split(' ')[0], 10) * 7;\r\n          }\r\n          if (dateStr.includes('months ago')) {\r\n            return parseInt(dateStr.split(' ')[0], 10) * 30;\r\n          }\r\n          return 0;\r\n        };\r\n        \r\n        return getNumericDays(a.postedDate) - getNumericDays(b.postedDate);\r\n      });\r\n    \r\n    case 'salary':\r\n      // 按薪资排序（高的在前面）\r\n      return sortedJobs.sort((a, b) => (b.salary || 0) - (a.salary || 0));\r\n    \r\n    case 'company':\r\n      // 按公司名称排序\r\n      return sortedJobs.sort((a, b) => a.company.localeCompare(b.company));\r\n    \r\n    case 'title':\r\n      // 按职位名称排序\r\n      return sortedJobs.sort((a, b) => a.title.localeCompare(b.title));\r\n    \r\n    default:\r\n      return sortedJobs;\r\n  }\r\n};\r\n\r\nexport default {\r\n  searchRemoteJobs,\r\n  fetchWeWorkRemotelyJobs,\r\n  fetchLinkedInJobs,\r\n  getJobDetails,\r\n  refreshCache,\r\n  getCacheStats\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}